diff --git a/src/buf.c b/src/buf.c
index 185083c..7fb57bc 100644
--- a/src/buf.c
+++ b/src/buf.c
@@ -100,7 +100,7 @@ struct Buf *buf_linedir (struct Buf *buf, const char* filename, int lineno)
 
     tsz = strlen("#line \"\"\n")                +   /* constant parts */
                2 * strlen (filename)            +   /* filename with possibly all backslashes escaped */
-               (size_t) (1 + ceil (log10 (abs (lineno)))) +   /* line number */
+               40 +   /* line number */
                1;                                   /* NUL */
     t = malloc(tsz);
     if (!t)
diff --git a/src/main.c b/src/main.c
index e5eac44..1c39478 100644
--- a/src/main.c
+++ b/src/main.c
@@ -468,7 +468,7 @@ void check_options (void)
              char *str, *fmt = "#define %s %d\n";
              size_t strsz;
 
-             strsz = strlen(fmt) + strlen(scname[i]) + (size_t)(1 + ceil (log10(i))) + 2;
+             strsz = strlen(fmt) + strlen(scname[i]) + 40 + 2;
              str = malloc(strsz);
              if (!str)
                flexfatal(_("allocation of macro definition failed"));
