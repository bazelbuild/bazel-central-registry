matrix:
  platform:
  - ubuntu2204
  - macos
  - macos_arm64
  bazel: [8.x]

tasks:
  verify_targets:
    name: Verify build targets
    platform: ${{ platform }}
    bazel: ${{ bazel }}
    build_targets:
    - '@dylib//:dylib'
  test_targets:
    name: Run tests
    platform: ${{ platform }}
    bazel: ${{ bazel }}
    test_targets:
    - '@dylib//:unit_tests'
    test_flags:
      - '--test_output=all'
