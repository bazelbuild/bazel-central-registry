load("@rules_cc//cc:defs.bzl", "cc_library")

package(default_visibility = ["//visibility:public"])

cc_library(
    name = "boost.beast",
    srcs = [
        "build_beast.cpp",
    ],
    hdrs = glob(
        [
            "include/**/*.hpp",
            "include/**/*.ipp",
        ],
        exclude = [
            "include/boost/beast/_experimental/http/impl/icy_stream.hpp",
            "include/boost/beast/_experimental/test/detail/stream_state.ipp",
            "include/boost/beast/_experimental/test/impl/error.hpp",
            "include/boost/beast/_experimental/test/impl/stream.hpp",
            "include/boost/beast/core/detail/bind_default_executor.hpp",
            "include/boost/beast/core/detail/buffer_traits.hpp",
            "include/boost/beast/core/detail/buffers_pair.hpp",
            "include/boost/beast/core/detail/impl/read.hpp",
            "include/boost/beast/core/detail/remap_post_to_defer.hpp",
            "include/boost/beast/core/detail/service_base.hpp",
            "include/boost/beast/core/detail/static_ostream.hpp",
            "include/boost/beast/core/detail/stream_base.hpp",
            "include/boost/beast/core/detail/work_guard.hpp",
            "include/boost/beast/core/impl/async_base.hpp",
            "include/boost/beast/core/impl/basic_stream.hpp",
            "include/boost/beast/core/impl/buffered_read_stream.hpp",
            "include/boost/beast/core/impl/buffers_cat.hpp",
            "include/boost/beast/core/impl/buffers_prefix.hpp",
            "include/boost/beast/core/impl/buffers_suffix.hpp",
            "include/boost/beast/core/impl/error.hpp",
            "include/boost/beast/core/impl/flat_buffer.hpp",
            "include/boost/beast/core/impl/flat_static_buffer.hpp",
            "include/boost/beast/core/impl/flat_stream.hpp",
            "include/boost/beast/core/impl/multi_buffer.hpp",
            "include/boost/beast/core/impl/read_size.hpp",
            "include/boost/beast/core/impl/saved_handler.hpp",
            "include/boost/beast/core/impl/static_buffer.hpp",
            "include/boost/beast/core/impl/string_param.hpp",
            "include/boost/beast/http/detail/rfc7230.hpp",
            "include/boost/beast/http/detail/rfc7230.ipp",
            "include/boost/beast/http/impl/error.hpp",
            "include/boost/beast/websocket/impl/error.hpp",
            "include/boost/beast/zlib/impl/error.hpp",
            "include/boost/beast/http/detail/type_traits.hpp",
            "include/boost/beast/http/impl/basic_parser.hpp",
            "include/boost/beast/http/impl/field.ipp",
            "include/boost/beast/http/impl/parser.hpp",
            "include/boost/beast/http/impl/chunk_encode.hpp","include/boost/beast/http/detail/rfc7230.hpp",
        ],
    ),
    defines = [
        "BOOST_BEAST_SEPARATE_COMPILATION",
        #"BOOST_BEAST_USE_STD_STRING_VIEW",
        #"BOOST_NO_CXX17_HDR_STRING_VIEW",
    ],
    features = [
        "parse_headers",
    ],
    includes = ["include"],
    textual_hdrs = [
        "include/boost/beast/http/impl/field.ipp",
        "include/boost/beast/_experimental/http/impl/icy_stream.hpp",
        "include/boost/beast/http/detail/type_traits.hpp",
        "include/boost/beast/_experimental/test/detail/stream_state.ipp",
        "include/boost/beast/http/impl/basic_parser.hpp",
        "include/boost/beast/_experimental/test/impl/error.hpp",
        "include/boost/beast/http/impl/parser.hpp",
        "include/boost/beast/http/impl/chunk_encode.hpp",
        "include/boost/beast/_experimental/test/impl/stream.hpp",
        "include/boost/beast/core/detail/bind_default_executor.hpp",
        "include/boost/beast/core/detail/buffer_traits.hpp",
        "include/boost/beast/core/detail/buffers_pair.hpp",
        "include/boost/beast/core/detail/impl/read.hpp",
        "include/boost/beast/core/detail/remap_post_to_defer.hpp",
        "include/boost/beast/core/detail/service_base.hpp",
        "include/boost/beast/core/detail/stream_base.hpp",
        "include/boost/beast/core/detail/work_guard.hpp",
        "include/boost/beast/core/impl/async_base.hpp",
        "include/boost/beast/core/impl/basic_stream.hpp",
        "include/boost/beast/core/impl/buffered_read_stream.hpp",
        "include/boost/beast/core/impl/buffers_cat.hpp",
        "include/boost/beast/core/impl/buffers_prefix.hpp",
        "include/boost/beast/core/impl/buffers_suffix.hpp",
        "include/boost/beast/core/impl/error.hpp",
        "include/boost/beast/core/impl/flat_buffer.hpp",
        "include/boost/beast/core/impl/flat_static_buffer.hpp",
        "include/boost/beast/core/impl/flat_stream.hpp",
        "include/boost/beast/core/impl/multi_buffer.hpp",
        "include/boost/beast/core/impl/read_size.hpp",
        "include/boost/beast/core/impl/saved_handler.hpp",
        "include/boost/beast/core/impl/static_buffer.hpp",
        "include/boost/beast/http/detail/rfc7230.hpp",
        "include/boost/beast/http/detail/rfc7230.ipp",
        "include/boost/beast/http/impl/error.hpp",
        "include/boost/beast/websocket/impl/error.hpp",
        "include/boost/beast/zlib/impl/error.hpp",
    ],
    deps = [
        "@boost.asio",
        "@boost.assert",
        "@boost.bind",
        "@boost.config",
        "@boost.container",
        "@boost.container_hash",
        "@boost.core",
        "@boost.endian",
        "@boost.intrusive",
        "@boost.logic",
        "@boost.mp11",
        "@boost.optional",
        "@boost.preprocessor",
        "@boost.smart_ptr",
        "@boost.static_assert",
        "@boost.static_string",
        "@boost.system",
        "@boost.throw_exception",
        "@boost.type_index",
        "@boost.type_traits",
        "@boost.winapi",
    ],
)
