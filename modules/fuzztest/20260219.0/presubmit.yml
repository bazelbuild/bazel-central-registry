matrix:
  platform:
  - ubuntu2004
  bazel:
  - 8.x
  - 7.x
tasks:
  verify_unix_targets:
    name: Verify build targets
    platform: ${{ platform }}
    bazel: ${{ bazel }}
    build_flags:
    - --action_env=CC=clang
    - --action_env=CXX=clang++
    - --host_cxxopt=-std=c++17
    - --cxxopt=-std=c++17
    - --cxxopt=-Wno-c++20-extensions
    build_targets:
    - '@fuzztest//fuzztest:fuzztest'
    - '@fuzztest//fuzztest:fuzztest_gtest_main'
    - '@fuzztest//centipede:centipede'
incompatible_flags:
  # Disabled due to transitive dependency on `aspect_bazel_lib`.
  "--incompatible_disable_native_repo_rules":
    - 8.x
  # Disabled due to transitive dependency on `rules_foreign_cc`.
  "--incompatible_autoload_externally=":
    - 8.x
