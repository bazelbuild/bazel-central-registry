matrix:
  platform:
  - ubuntu2004
  bazel:
  - 7.x
  - 6.x
tasks:
  verify_unix_targets:
    name: Verify build targets
    platform: ${{ platform }}
    bazel: ${{ bazel }}
    build_flags:
    - --action_env=CC=clang
    - --action_env=CXX=clang++
    - --host_cxxopt=-std=c++17
    - --cxxopt=-std=c++17
    - --cxxopt=-Wno-c++20-extensions
    - --copt=-DADDRESS_SANITIZER
    - --dynamic_mode=off
    - --copt=-D_LIBCPP_ENABLE_ASSERTIONS=1
    - --linkopt=-fsanitize=address
    - --copt=-fsanitize=address
    build_targets:
    - '@fuzztest//fuzztest:fuzztest'
    - '@fuzztest//centipede:centipede'