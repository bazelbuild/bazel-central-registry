build_targets: &build_targets
  - "@boringssl//:crypto"
  - "@boringssl//:ssl"

matrix:
  platform:
    # The current version of centos on Bazel CI still uses gcc 4.8.5
    # Re-enable this platform when the gcc version is upgraded.
    # - centos7
    - debian10
    - ubuntu2004
    - windows
  bazel: [6.x, 7.x]
tasks:
  verify_targets:
    name: Verify build targets
    platform: ${{ platform }}
    bazel: ${{ bazel }}
    build_targets: *build_targets
  # Work around https://github.com/bazelbuild/bazel/issues/10472
  verify_targets_on_macos:
    name: Verify build targets on macOS
    platform: macos
    bazel: ${{ bazel }}
    build_targets: *build_targets
    build_flags:
      - --copt=-isystem/usr/local/include
