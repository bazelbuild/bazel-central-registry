--- a/plugins/crypto/openssl/securitypolicy_openssl_common.c	2025-11-08 21:11:04.379978999 -0500
+++ b/plugins/crypto/openssl/securitypolicy_openssl_common.c	2025-11-08 21:11:36.460727438 -0500
@@ -135,7 +135,10 @@
     }
 
     if(padding == RSA_PKCS1_PSS_PADDING) {
+        // See https://source.corp.google.com/piper///depot/google3/third_party/openssl/boringssl/src/include/openssl/evp.h;rcl=620966069;l=732
+        #define RSA_PSS_SALTLEN_DIGEST -1
         opensslRet = EVP_PKEY_CTX_set_rsa_pss_saltlen(evpKeyCtx, RSA_PSS_SALTLEN_DIGEST);
+        #undef RSA_PSS_SALTLEN_DIGEST
         if(opensslRet != 1) {
             ret = UA_STATUSCODE_BADINTERNALERROR;
             goto errout;
@@ -583,7 +586,10 @@
     }
     EVP_PKEY_CTX_set_rsa_padding (evpKeyCtx, padding);
     if(padding == RSA_PKCS1_PSS_PADDING) {
+        // See https://source.corp.google.com/piper///depot/google3/third_party/openssl/boringssl/src/include/openssl/evp.h;rcl=620966069;l=732
+#define RSA_PSS_SALTLEN_DIGEST -1
         opensslRet = EVP_PKEY_CTX_set_rsa_pss_saltlen(evpKeyCtx, RSA_PSS_SALTLEN_DIGEST); //RSA_PSS_SALTLEN_DIGEST
+#undef RSA_PSS_SALTLEN_DIGEST
         if (opensslRet != 1) {
             ret = UA_STATUSCODE_BADINTERNALERROR;
             goto errout;
--- a/plugins/crypto/openssl/ua_pki_openssl.c	2025-11-08 21:11:20.714787117 -0500
+++ b/plugins/crypto/openssl/ua_pki_openssl.c	2025-11-08 21:11:36.462008395 -0500
@@ -10,6 +10,7 @@
 #include <open62541/plugin/pki_default.h>
 
 #include "securitypolicy_openssl_common.h"
+#include "include/openssl/asn1.h"
 
 #if defined(UA_ENABLE_ENCRYPTION_OPENSSL) || defined(UA_ENABLE_ENCRYPTION_LIBRESSL)
 #include <openssl/x509.h>
@@ -815,10 +816,12 @@
 
     /* Get the certificate Expiry date */
     ASN1_TIME *not_after = X509_get_notAfter(x509);
+    time_t utcTime;
+    ASN1_TIME_to_time_t(not_after, &utcTime);
+    X509_free(x509);
 
     struct tm dtTime;
-    ASN1_TIME_to_tm(not_after, &dtTime);
-    X509_free(x509);
+    gmtime_r(&utcTime, &dtTime);
 
     struct musl_tm dateTime;
     memset(&dateTime, 0, sizeof(struct musl_tm));
