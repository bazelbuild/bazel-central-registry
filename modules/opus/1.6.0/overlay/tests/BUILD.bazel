load("@rules_cc//cc:defs.bzl", "cc_library", "cc_test")
load("//:defs.bzl", "OPUS_COPTS")

package(default_visibility = ["//visibility:public"])

cc_library(
    name = "test_support",
    hdrs = ["test_opus_common.h"],
    copts = OPUS_COPTS,
    deps = ["//:opus"],
)

cc_test(
    name = "test_opus_api",
    srcs = ["test_opus_api.c"],
    copts = OPUS_COPTS,
    deps = [
        "//:opus",
        ":test_support",
    ],
)

cc_test(
    name = "test_opus_decode",
    srcs = ["test_opus_decode.c"],
    copts = OPUS_COPTS,
    deps = [
        "//:opus",
        ":test_support",
    ],
    timeout = "moderate",
)

cc_test(
    name = "test_opus_encode",
    srcs = [
        "test_opus_encode.c",
        "opus_encode_regressions.c",
    ],
    copts = OPUS_COPTS,
    deps = [
        "//:opus",
        ":test_support",
    ],
    timeout = "long",
)

cc_test(
    name = "test_opus_extensions",
    srcs = ["test_opus_extensions.c"],
    copts = OPUS_COPTS,
    deps = [
        "//:opus",
        ":test_support",
    ],
    timeout = "moderate",
)

cc_test(
    name = "test_opus_padding",
    srcs = ["test_opus_padding.c"],
    copts = OPUS_COPTS,
    deps = [
        "//:opus",
        ":test_support",
    ],
)

cc_test(
    name = "test_opus_projection",
    srcs = ["test_opus_projection.c"],
    copts = OPUS_COPTS,
    deps = [
        "//:opus",
        ":test_support",
    ],
    timeout = "moderate",
)
