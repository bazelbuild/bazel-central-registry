load("//private:verilator_utils.bzl", "verilator_coverage_internal_test", "verilator_internal_test")

verilator_internal_test(
    # Demonstrate hermetic build works with `--hierarchical` switch
    name = "test_hierarchical",
    srcs = ["t/t_hier_block_int.v"],
    top_module = "t",
    verilator_args = ["--cc", "--hierarchical"],
)

verilator_internal_test(
    # Ensure `--build` can find runtime support files in runfiles.
    name = "test_build_runtime_support",
    srcs = ["t/t_hier_block_int.v"],
    top_module = "t",
    verilator_args = ["--cc", "--build"],
)

verilator_coverage_internal_test(
    name = "test_coverage_write_info",
    srcs = [
        "t/t_vlcov_data_a.dat",
        "t/t_vlcov_data_b.dat",
        "t/t_vlcov_data_c.dat",
        "t/t_vlcov_data_d.dat",
    ],
    expected = "t/t_vlcov_info.info.out",
)
