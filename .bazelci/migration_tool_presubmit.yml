---
tasks:
  cross_platform_tests:
    strategy:
      matrix:
        platform: [ubuntu2204, macos, windows]
        test_case: [go, maven, python, simple_deps]

        include:
          - test_case: go
            directory: go_extension
            script: migration_test.py
          - test_case: maven
            directory: maven_extensions
            script: ../migration_test.py
          - test_case: python
            directory: py_extension
            script: ../migration_test.py
          - test_case: simple_deps
            directory: simple_module_deps
            script: migration_test.py

    platform: '{{matrix.platform}}'
    name: '{{matrix.test_case}}_{{matrix.platform}}'
    shell_commands:
      - cd tools/bzlmod_migration_test_examples/{{matrix.directory}} && python3 {{matrix.script}}