matrix:
  platform: [macos, ubuntu2004, windows]
  test_case: [go, maven, python, simple_deps]
  include:
    - test_case: go
      directory: go_extension
      script: migration_test.py
    - test_case: maven
      directory: maven_extensions
      script: ../migration_test.py
    - test_case: python
      directory: py_extension
      script: ../migration_test.py
    - test_case: simple_deps
      directory: simple_module_deps
      script: migration_test.py
  
tasks:
  cross_platform_tests:
    name: ${{ test_case }}_${{ platform }}
    platform: ${{ platform }}
    shell_commands:
      - cd tools/bzlmod_migration_test_examples/${{ directory }} && python3 ${{ script }}
